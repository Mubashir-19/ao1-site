import*as e from"https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.module.js";import{GLTFLoader as ye}from"https://cdn.jsdelivr.net/npm/three@0.137.0/examples/jsm/loaders/GLTFLoader.js";import{CSS2DRenderer as xe,CSS2DObject as be}from"https://cdn.jsdelivr.net/npm/three@0.167.0/examples/jsm/renderers/CSS2DRenderer.js";import"https://cdn.jsdelivr.net/npm/stats-js@1.0.1/+esm";import oe from"https://cdn.jsdelivr.net/npm/gsap@3.12.5/+esm";import"https://cdn.jsdelivr.net/npm/three@0.137.0/examples/jsm/controls/OrbitControls.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}})();document.getElementById("userInput").addEventListener("keypress",function(t){t.key==="Enter"&&ve()});function ve(){const t=document.getElementById("userInput"),n=t.value.trim();if(!n)return;Ee(n,"user-message");const a=Z({role:"user",content:n});t.value="",fetch("https://chat-pump-fun.vercel.app/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:a.slice(-5)})}).then(r=>r.json()).then(r=>Ae(r)).catch(r=>console.error("Error:",r))}function Ee(t,n){const a=document.getElementById("chatbox"),r=document.createElement("div");r.className=n,r.innerText=t,a.appendChild(r),a.scrollTop=a.scrollHeight}document.getElementById("clear-chat").addEventListener("click",function(){localStorage.setItem("pumpMessages",JSON.stringify([])),location.reload()});function Ae(t){const n=document.getElementById("chatbox");let a="";if(t.message){a=t.message;const r=document.createElement("div");r.className="bot-message",r.innerHTML=marked.parse(a),n.appendChild(r),n.scrollTop=n.scrollHeight,a&&Z({role:"assistant",content:a})}else if(Array.isArray(t)){a=t.map((o,l)=>`**${l+1}. ${o.name} (${o.symbol})**

${o.description||"No description available."}

- **Market Cap:** $${o.usd_market_cap.toLocaleString()}
- **Mint Address:** \`${o.mint}\`
- **Created:** ${new Date(o.created_timestamp).toLocaleDateString()}
`+(o.website?`- [Visit Website](${o.website})
`:"")+(o.twitter?`- [Twitter](${o.twitter})
`:"")+(o.telegram?`- [Telegram](${o.telegram})
`:"")+`- **Last Trade:** ${o.last_trade_timestamp?new Date(o.last_trade_timestamp).toLocaleString():"N/A"}
- **Liquidity:** ${o.virtual_sol_reserves?o.virtual_sol_reserves.toLocaleString():"N/A"} SOL | ${o.virtual_token_reserves?o.virtual_token_reserves.toLocaleString():"N/A"} Tokens
`+(o.bonding_curve?`- **Bonding Curve:** \`${o.bonding_curve}\`
`:"")).join(`
---
`);const r=document.createElement("div");if(r.className="bot-message",item.warnings&&item.warnings.includes("extreme")||item.warnings&&item.warnings.includes("high influence"),r.innerHTML=marked.parse(a),n.appendChild(r),n.scrollTop=n.scrollHeight,a){let o=a.split(`
---
`);Z({role:"assistant",content:o.slice(0,5).join(`
---
`)})}}}function Z(t){let n=JSON.parse(localStorage.getItem("pumpMessages"))||[];return n.push(t),n.length>10&&(n=n.slice(-10)),localStorage.setItem("pumpMessages",JSON.stringify(n)),n}function _e(){const t=document.getElementById("chatbox");(JSON.parse(localStorage.getItem("pumpMessages"))||[]).forEach(a=>{const r=document.createElement("div");r.className=a.role==="user"?"user-message":"bot-message",a.role==="assistant"?(r.innerHTML=marked.parse(a.content),console.log(r)):r.innerText=a.content,t.appendChild(r)}),t.scrollTop=t.scrollHeight}const Q=new URL(window.location.href),ne=Q.searchParams.get("referral");let ie;ne&&(localStorage.setItem("referralCode",ne),Q.searchParams.delete("referral"),window.history.replaceState({},document.title,Q.toString()));auth0.createAuth0Client({domain:"dev-h3yoa2wh4h62cg58.us.auth0.com",clientId:"Onsw2Vpuv8bFAsuSTI5uzt7xdlyw0bnV",authorizationParams:{redirect_uri:window.location.origin}}).then(async t=>{const n=document.getElementById("signin");n.addEventListener("click",l=>{l.preventDefault(),t.loginWithRedirect()}),location.search.includes("state=")&&(location.search.includes("code=")||location.search.includes("error="))&&(await t.handleRedirectCallback(),window.history.replaceState({},document.title,"/"));const a=document.getElementById("logout");a.addEventListener("click",l=>{l.preventDefault(),t.logout()}),ie=await t.isAuthenticated(),document.getElementById("loading").style.display="none";const r=await t.getUser(),o=document.getElementById("profile");if(ie){const l=localStorage.getItem("referralCode"),c=l?atob(l).replace(/^ref_/,""):"";fetch("/api/create_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,inviterEmail:c})}),l&&localStorage.removeItem("referralCode"),n.style.display="none",o.style.display="block",a.style.display="block";const b=btoa(`ref_${r.email}`),w=`${window.location.origin}?referral=${b}`;document.getElementById("copy-referral").addEventListener("click",()=>{navigator.clipboard.writeText(w).then(()=>{alert("Referral link copied!")}).catch(f=>{console.error("Failed to copy:",f)})})}else o.style.display="none",n.style.display="block",a.style.display="none"});const Se=`
uniform float pointMultiplier;

attribute float size;
attribute float angle;
attribute vec4 aColor;

varying vec4 vColor;
varying vec2 vAngle;

void main() {
  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);

  gl_Position = projectionMatrix * mvPosition;
  gl_PointSize = size * pointMultiplier / gl_Position.w;

  vAngle = vec2(cos(angle), sin(angle));
  vColor = aColor;
}`,Me=`
uniform sampler2D diffuseTexture;

varying vec4 vColor;
varying vec2 vAngle;

void main() {
  vec2 coords = (gl_PointCoord - 0.5) * mat2(vAngle.x, vAngle.y, -vAngle.y, vAngle.x) + 0.5;
  gl_FragColor = texture2D(diffuseTexture, coords) * vColor;
}`;function G(t){const n=[],a=t;function r(l,c){n.push([l,c])}function o(l){let c=0;for(let w=0;w<n.length&&!(n[w][0]>=l);w++)c=w;const b=Math.min(n.length-1,c+1);return c==b?n[c][1]:a((l-n[c][0])/(n[b][0]-n[c][0]),n[c][1],n[b][1])}return{addPoint:r,getValueAt:o}}function Le(t){const{camera:n,emitter:a,parent:r,rate:o,texture:l}=t,c={diffuseTexture:{value:new e.TextureLoader().load(l)},pointMultiplier:{value:window.innerHeight/(2*Math.tan(30*Math.PI/180))}},b=new e.ShaderMaterial({uniforms:c,vertexShader:Se,fragmentShader:Me,blending:e.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0,vertexColors:!0});let w=[];const f=new e.BufferGeometry;f.setAttribute("position",new e.Float32BufferAttribute([],3)),f.setAttribute("size",new e.Float32BufferAttribute([],1)),f.setAttribute("aColor",new e.Float32BufferAttribute([],4)),f.setAttribute("angle",new e.Float32BufferAttribute([],1));const N=new e.Points(f,b);r.add(N);const L=G((u,i,m)=>i+u*(m-i));L.addPoint(0,0),L.addPoint(.6,1),L.addPoint(1,0);const C=G((u,i,m)=>i.clone().lerp(m,u));C.addPoint(0,new e.Color(16777215)),C.addPoint(1,new e.Color(16744576));const M=G((u,i,m)=>i+u*(m-i));M.addPoint(0,0),M.addPoint(1,1);const P=.5,y=1,F=6;let B=0;function $(u){B+=u;const i=Math.floor(B*o);B-=i/o;for(let m=0;m<i;m+=1){const d=(Math.random()*.75+.25)*y;w.push({position:new e.Vector3((Math.random()*2-1)*P,(Math.random()*2-1)*P,(Math.random()*2-1)*P).add(a.position),size:(Math.random()*.5+.5)*F,colour:new e.Color,alpha:1,life:d,maxLife:d,rotation:Math.random()*2*Math.PI,rotationRate:Math.random()*.01-.005,velocity:new e.Vector3(0,1.5,0)})}}function W(){const u=[],i=[],m=[],d=[];for(let s of w)u.push(s.position.x,s.position.y,s.position.z),m.push(s.colour.r,s.colour.g,s.colour.b,s.alpha),i.push(s.currentSize),d.push(s.rotation);f.setAttribute("position",new e.Float32BufferAttribute(u,3)),f.setAttribute("size",new e.Float32BufferAttribute(i,1)),f.setAttribute("aColor",new e.Float32BufferAttribute(m,4)),f.setAttribute("angle",new e.Float32BufferAttribute(d,1)),f.attributes.position.needsUpdate=!0,f.attributes.size.needsUpdate=!0,f.attributes.aColor.needsUpdate=!0,f.attributes.angle.needsUpdate=!0}W();function v(u){for(let i of w)i.life-=u;w=w.filter(i=>i.life>0);for(let i of w){const m=1-i.life/i.maxLife;i.rotation+=i.rotationRate,i.alpha=L.getValueAt(m),i.currentSize=i.size*M.getValueAt(m),i.colour.copy(C.getValueAt(m)),i.position.add(i.velocity.clone().multiplyScalar(u));const d=i.velocity.clone();d.multiplyScalar(u*.1),d.x=Math.sign(i.velocity.x)*Math.min(Math.abs(d.x),Math.abs(i.velocity.x)),d.y=Math.sign(i.velocity.y)*Math.min(Math.abs(d.y),Math.abs(i.velocity.y)),d.z=Math.sign(i.velocity.z)*Math.min(Math.abs(d.z),Math.abs(i.velocity.z)),i.velocity.sub(d)}w.sort((i,m)=>{const d=n.position.distanceTo(i.position),s=n.position.distanceTo(m.position);return d>s?-1:d<s?1:0})}function j(u){$(u),v(u),W()}return{update:j}}const Te=[{name:"about",text:"about about about about about about about about about about about about about about about about about about about about about "},{name:"framework",text:"framework framework framework framework framework framework framework framework framework framework framework framework framework "},{name:"roadmap",text:"roadmap roadmap roadmap roadmap roadmap  text text text text text text text text text text text text text text text text text text text text text text text text text text  "},{name:"use-case",text:"use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case use-case  "},{name:"tokenomics",text:"tokenomics tokenomics tokenomics text text text text text text text text text text text text text text text text text text text text text text text text text text "}],I=Object.fromEntries(Te.map(t=>[t.name,t.text])),J=2,ke=.6,Ce=.15;let q=!0;const re=!1,z=!0,ae=.002,se=.004,Pe=new e.Vector3(4.73,3.11,21.76),Be=new e.Vector3(7.49,9.41,51.19),Ie=new e.Vector3(-.074,.33,.024),ze=new e.Vector3(-.13,.183,.024);let E,k,K=!1;const H={x:window.innerWidth/2,y:window.innerHeight/2},S={x:0,y:0},g={};window.onload=function(){window.scrollTo(0,0)};let Y=!1;var X=new e.Vector2,le=new Audio("audio/fire_sound.mp3");le.volume=.1;var ee=new Audio("audio/window_sound.mp3");ee.volume=.05;var D=new Audio("audio/wind_sound.mp3");D.volume=.005;const Oe=new e.MeshBasicMaterial({color:65280,transparent:!0,opacity:0,depthTest:!1}),p=new e.Scene,x=new e.PerspectiveCamera(35,innerWidth/innerHeight,.01,200),R=new e.WebGLRenderer({antialias:!0,alpha:!0,canvas:document.querySelector("#canvas3d")});R.setPixelRatio(devicePixelRatio);R.setSize(window.innerWidth,window.innerHeight);R.setClearColor(16777215,0);const Re=new e.BoxGeometry(1,1,1),h=new e.Mesh(Re,Oe);p.add(h);h.position.x=-5.5;h.position.y=2.3;h.position.z=0;h.scale.y=4;h.scale.x=2.2;window.addEventListener("mousemove",t=>{H.x=t.clientX,H.y=t.clientY});const Ve=new e.PointsMaterial({color:"#aaa",size:.3,transparent:!0}),ce=new e.BufferGeometry,de=1e4,ue=new Float32Array(de*3);for(let t=0;t<de*3;t++)ue[t]=(Math.random()-.5)*3;ce.setAttribute("position",new e.BufferAttribute(ue,3));const A=new e.Points(ce,Ve);A.position.y=11;A.position.z=-19;A.position.x=-50;A.scale.x=44;A.scale.z=4;A.scale.y=44;A.rotation.x=-.5;p.add(A);const te=new e.LoadingManager;te.onLoad=()=>Ne();te.onError=t=>{console.error(`Error loading ${t}`)};const V=new ye(te);V.load("3d/room.glb",function(t){g.room=t.scene});V.load("3d/window.glb",function(t){g.window_model=t.scene,g.windowAnimations=t.animations});V.load("3d/firewood.glb",function(t){g.firewood=t.scene});V.load("3d/parts.glb",function(t){g.parts=t.scene});V.load("3d/girl.glb",function(t){g.girl=t.scene,g.girlAnimations=t.animations});function Ne(){me(),window.addEventListener("resize",t,!1);function t(){x.aspect=window.innerWidth/window.innerHeight,x.updateProjectionMatrix(),R.setSize(window.innerWidth,window.innerHeight),y.setSize(window.innerWidth,window.innerHeight)}x.position.set(E.x,E.y,E.z),x.rotation.set(k.x,k.y,k.z);let n=g.room;p.add(g.firewood),p.add(g.parts);let a,r;a=new e.AnimationMixer(g.girl),r=a.clipAction(g.girlAnimations[0]),r.loop=e.LoopRepeat,r.clampWhenFinished=!1,p.add(g.girl),r.play(),p.add(n);let o,l,c,b=g.window_model;o=g.windowAnimations,l=new e.AnimationMixer(b),c=l.clipAction(o[0]),c.clampWhenFinished=!0,c.loop=e.LoopOnce,p.add(b);function w(){ee.play(),D.volume=.03,h.position.x=-7.5,h.position.z=1,h.rotation.y=1,Y=!0,c.play(),c.timeScale=1,c.paused=!1}function f(){setTimeout(function(){D.volume=.005,ee.play()},500),h.position.x=-5.5,h.position.z=0,h.rotation.y=0,Y=!1,c.timeScale=-1,c.paused=!1}const N=new e.Raycaster;window.addEventListener("click",s=>{le.play(),D.play(),X.x=s.clientX/window.innerWidth*2-1,X.y=-(s.clientY/window.innerHeight)*2+1,N.setFromCamera(X,x);const _=N.intersectObjects(p.children);_.length>0&&_[0].object==h&&(Y?f():w())});const L=new e.BoxGeometry(.1,.1,.1),C=new e.MeshBasicMaterial({color:16711680}),M=new e.Mesh(L,C);p.add(M),M.position.set(0,.1,.5);const P=Le({camera:x,emitter:M,parent:p,rate:200,texture:"images/fire.png"}),y=new xe;y.setSize(window.innerWidth,window.innerHeight),y.domElement.style.position="absolute",y.domElement.style.top="0px",y.domElement.style.pointerEvents="none",y.domElement.style.zIndex="222",document.body.appendChild(y.domElement),p.add(T("talk to penelope",new e.Vector3(-4.8,-.5,5.5))),p.add(T("framework",new e.Vector3(0,-.5,7))),p.add(T("about",new e.Vector3(0,.2,2))),p.add(T("tokenomics",new e.Vector3(-6,-.4,11))),p.add(T("use-case",new e.Vector3(5.5,.8,.5))),p.add(T("roadmap",new e.Vector3(4.1,4.9,.5)));function F(){document.getElementById("header-wrapper").classList.remove("fade-out")}function B(){document.getElementById("header-wrapper").classList.add("fade-out")}function $(){let s=document.getElementById("back-btn-wrapper");s.classList.remove("fade-out"),s.classList.add("fade-in")}function W(){let s=document.getElementById("back-btn-wrapper");s.classList.add("fade-out"),s.classList.remove("fade-in")}function v(s,_,he,U=!1){q=!1,U?W():(j(),B()),oe.to(x.rotation,{x:_.x,y:_.y,z:_.z,duration:J,ease:"power2.inOut"}),oe.to(x.position,{x:s.x,y:s.y,z:s.z,duration:J,ease:"power2.inOut",onComplete:()=>{he&&We(),U&&(q=!0,S.x=window.innerWidth/2,S.y=window.innerHeight/2),U?(u(),F()):$()}})}setTimeout(()=>{document.getElementById("roadmap").addEventListener("click",()=>{i(I.roadmap),v(new e.Vector3(4.59,3.275,9.499),new e.Euler(.23,.07,-.016),z)}),document.getElementById("framework").addEventListener("click",()=>{i(I.framework),v(new e.Vector3(-.28,7.458,10.845),new e.Euler(-1.051,0,0),z)}),document.getElementById("tokenomics").addEventListener("click",()=>{i(I.tokenomics),v(new e.Vector3(-1.562,3.715,10.891),new e.Euler(-1.582,.794,1.587),z)}),document.getElementById("about").addEventListener("click",()=>{i(I.about),v(new e.Vector3(0,6.112,10),new e.Euler(-.495,0,0),z)}),document.getElementById("use-case").addEventListener("click",()=>{i(I["use-case"]),v(new e.Vector3(5.77,3,10.166),new e.Euler(-.059,.0245,0),z)}),document.getElementById("talk to penelope").addEventListener("click",()=>{v(new e.Vector3(-3.139,2.102,10.139),new e.Euler(-.219,.2107,.046),re),setTimeout(()=>{De(),K=!0},J*1e3)}),document.getElementById("back-btn").addEventListener("click",()=>{document.getElementById("paper-wrapper").classList.remove("paper-wrapper-on"),v(E,k,re,!0),K&&(He(),K=!1)})},1);function j(){y.domElement.style.display="none"}function u(){y.domElement.style.display="block"}function i(s){const _=document.getElementById("paper-text");_.textContent=s}let m=new e.Clock;function d(){let s=m.getDelta();l&&l.update(s),a&&a.update(s),A.rotation.z-=s*Ce,P.update(s*ke),S.x+=(H.x-S.x)*se,S.y+=(H.y-S.y)*se,x&&q&&x.position.set(E.x+ae*(S.x-window.innerWidth/2),E.y-ae*(S.y-window.innerHeight/2),E.z),requestAnimationFrame(d),R.render(p,x),y.render(p,x)}d()}function T(t,n){const a=document.createElement("button");a.textContent=t,a.style.pointerEvents="auto",a.classList.add("scene-button"),a.id=t;const r=new be(a);return r.position.copy(n),r}function We(){document.getElementById("paper-wrapper").classList.add("paper-wrapper-on")}let O=pe();O?fe():we();function me(){pe()?(O||fe(),O=!0):(O&&we(),O=!1)}function pe(){return window.innerWidth>700}window.addEventListener("resize",function(){me()});function fe(){E=Pe,k=Ie,console.log("toLandscape")}function we(){E=Be,k=ze,console.log("toPortrait")}const ge=document.getElementsByClassName("main-chat-container")[0];function De(){console.log("showChat called!"),ge.style.display="flex",_e()}function He(){console.log("hideChat called!"),ge.style.display="none"}
